<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACTC - 國際資訊安全人才培育與推廣協會</title>
    <link rel="icon" type="image/x-icon" href="assets/icons/favicon.ico">
    <link rel="apple-touch-icon" href="assets/icons/favicon.ico">
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'actc-orange': '#F97316',
                        'actc-orange-light': '#FB923C',
                        'actc-orange-dark': '#EA580C'
                    }
                }
            }
        }
    </script>
    <style>
        /* Swiper 自定義樣式 */
        .swiper-button-next,
        .swiper-button-prev {
            color: #F97316 !important;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            width: 40px !important;
            height: 40px !important;
            margin-top: -20px !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .swiper-button-next::after,
        .swiper-button-prev::after {
            font-size: 16px !important;
            font-weight: bold;
        }

        .swiper-pagination-bullet {
            background: rgba(255, 255, 255, 0.7) !important;
            opacity: 1 !important;
        }

        .swiper-pagination-bullet-active {
            background: #F97316 !important;
        }

        .swiper-pagination {
            bottom: 12px !important;
        }

        /* 新聞卡片圖片樣式 */
        .news-card-image {
            border-radius: 0.5rem 0.5rem 0 0;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- 導航欄 -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <!-- JPG Logo for Navigation -->
                    <div class="w-10 h-10">
                        <img src="assets/images/actc-logo.jpg" alt="ACTC Logo" class="w-full h-full object-contain rounded-full">
                    </div>
                    <span class="text-xl font-bold text-gray-800">ACTC</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="#home" class="text-gray-600 hover:text-actc-orange transition-colors">首頁</a>
                    <a href="about.html" class="text-gray-600 hover:text-actc-orange transition-colors">關於協會</a>
                    <a href="#news" class="text-gray-600 hover:text-actc-orange transition-colors">最新消息</a>
                    <a href="#events" class="text-gray-600 hover:text-actc-orange transition-colors">活動課程</a>
                    <a href="workgroups.html" class="text-gray-600 hover:text-actc-orange transition-colors">工作小組</a>
                </div>
                <div class="md:hidden">
                    <button class="text-gray-600 hover:text-actc-orange">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- 首頁區塊 -->
    <section id="home" class="bg-gradient-to-br from-actc-orange to-actc-orange-dark text-white py-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <!-- Logo 圖片 -->
            <div class="mb-8">
                <!-- JPG Logo - 使用您的設計 -->
                <div class="w-64 h-64 mx-auto">
                    <img src="assets/images/actc-logo.jpg" alt="ACTC Logo" class="w-full h-full object-contain">
                </div>
            </div>
            <h1 class="text-4xl md:text-6xl font-bold mb-6">ACTC</h1>
            <h2 class="text-xl md:text-2xl mb-8">國際資訊安全人才培育與推廣協會</h2>
            <p class="text-lg md:text-xl max-w-3xl mx-auto opacity-90">
                致力於推動資訊安全教育，培養專業人才，建立安全的數位環境
            </p>
        </div>
    </section>

    <!-- 協會宗旨 -->
    <section class="py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">協會宗旨</h2>
                <div class="w-24 h-1 bg-actc-orange mx-auto"></div>
            </div>
            
            <!-- 協會性質與立案資訊 -->
            <div class="bg-gradient-to-r from-actc-orange to-actc-orange-dark text-white rounded-lg p-8 mb-12 text-center">
                <p class="text-lg leading-relaxed mb-4">
                    本會為依法設立、非以營利為目的之公益性社會團體，以推動國際資訊安全人才培育之生態系良好發展為宗旨。
                </p>
                <div class="text-sm text-white/90 space-y-1">
                    <p>成立日期：112/2/17</p>
                    <p>立案編號：1120022057</p>
                </div>
            </div>

            <!-- 宗旨目標 -->
            <div class="grid md:grid-cols-3 gap-8">
                <div class="text-center">
                    <div class="w-20 h-20 bg-actc-orange rounded-full flex items-center justify-center mx-auto mb-6">
                        <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">推廣資訊安全教育</h3>
                    <p class="text-gray-600">透過各種管道推廣資訊安全知識，提升社會大眾的資安意識</p>
                </div>
                <div class="text-center">
                    <div class="w-20 h-20 bg-actc-orange rounded-full flex items-center justify-center mx-auto mb-6">
                        <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">培養專業人才</h3>
                    <p class="text-gray-600">建立完善的人才培育體系，為產業提供優秀的資安專業人員</p>
                </div>
                <div class="text-center">
                    <div class="w-20 h-20 bg-actc-orange rounded-full flex items-center justify-center mx-auto mb-6">
                        <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">國際交流合作</h3>
                    <p class="text-gray-600">促進國際間的資安技術交流，建立良好的合作關係</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 最新消息 -->
    <section id="news" class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">最新消息</h2>
                <div class="w-24 h-1 bg-actc-orange mx-auto"></div>
            </div>
            
            <!-- 載入中狀態 -->
            <div id="news-loading" class="text-center py-12">
                <div class="inline-flex items-center px-4 py-2 font-semibold leading-6 text-actc-orange">
                    <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-actc-orange" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    載入最新消息中...
                </div>
            </div>

            <!-- 空狀態 -->
            <div id="news-empty" class="hidden text-center py-12">
                <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
                <h3 class="mt-2 text-sm font-medium text-gray-900">暫無最新消息</h3>
                <p class="mt-1 text-sm text-gray-500">目前沒有最新的消息公告</p>
            </div>

            <!-- 錯誤狀態 -->
            <div id="news-error" class="hidden text-center py-12">
                <svg class="mx-auto h-12 w-12 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z" />
                </svg>
                <h3 class="mt-2 text-sm font-medium text-gray-900">載入失敗</h3>
                <p class="mt-1 text-sm text-gray-500">無法載入最新消息，請稍後再試</p>
            </div>

            <!-- 新聞容器 -->
            <div id="news-container" class="hidden grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- 動態載入的新聞內容 -->
            </div>
        </div>
    </section>

    <!-- 活動課程列表 -->
    <section id="events" class="py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">活動課程</h2>
                <div class="w-24 h-1 bg-actc-orange mx-auto"></div>
            </div>
            
            <!-- 載入中狀態 -->
            <div id="events-loading" class="text-center py-12">
                <div class="inline-flex items-center px-4 py-2 font-semibold leading-6 text-actc-orange">
                    <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-actc-orange" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    載入活動課程中...
                </div>
            </div>

            <!-- 空狀態 -->
            <div id="events-empty" class="hidden text-center py-12">
                <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
                <h3 class="mt-2 text-sm font-medium text-gray-900">暫無活動課程</h3>
                <p class="mt-1 text-sm text-gray-500">目前沒有活動課程安排</p>
            </div>

            <!-- 錯誤狀態 -->
            <div id="events-error" class="hidden text-center py-12">
                <svg class="mx-auto h-12 w-12 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z" />
                </svg>
                <h3 class="mt-2 text-sm font-medium text-gray-900">載入失敗</h3>
                <p class="mt-1 text-sm text-gray-500">無法載入活動課程，請稍後再試</p>
            </div>

            <!-- 活動容器 -->
            <div id="events-container" class="hidden grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- 動態載入的活動內容 -->
            </div>
        </div>
    </section>

    <!-- 頁尾 -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-3 gap-8">
                <div>
                    <div class="flex items-center space-x-3 mb-4">
                        <!-- JPG Logo for Footer -->
                        <div class="w-10 h-10">
                            <img src="assets/images/actc-logo.jpg" alt="ACTC Logo" class="w-full h-full object-contain rounded-full">
                        </div>
                        <span class="text-xl font-bold">ACTC</span>
                    </div>
                    <p class="text-gray-300 mb-4">國際資訊安全人才培育與推廣協會</p>
                    <p class="text-gray-400 text-sm">致力於推動資訊安全教育，培養專業人才</p>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">聯絡資訊</h3>
                    <div class="space-y-2 text-gray-300">
                        <p>電話：(02) 2345-6789</p>
                        <p>傳真：(02) 2345-6790</p>
                        <p>信箱：info@actc.org.tw</p>
                        <p>地址：105台北市松山區復興北路57號</p>
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">快速連結</h3>
                    <div class="space-y-2">
                        <a href="about.html" class="block text-gray-300 hover:text-actc-orange transition-colors">關於協會</a>
                        <a href="#news" class="block text-gray-300 hover:text-actc-orange transition-colors">最新消息</a>
                        <a href="#events" class="block text-gray-300 hover:text-actc-orange transition-colors">活動課程</a>
                        <a href="workgroups.html" class="block text-gray-300 hover:text-actc-orange transition-colors">工作小組</a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center">
                <p class="text-gray-400">&copy; 2025 ACTC - 國際資訊安全人才培育與推廣協會. 版權所有.</p>
            </div>
        </div>
    </footer>

    <!-- 新聞管理 JavaScript -->
    <script>
        // 新聞管理
        class NewsManager {
            constructor() {
                this.newsContainer = document.getElementById('news-container');
                this.newsLoading = document.getElementById('news-loading');
                this.newsEmpty = document.getElementById('news-empty');
                this.newsError = document.getElementById('news-error');
                this.swiperInstances = [];
                this.init();
            }

            async init() {
                await this.loadNews();
            }

            async loadNews() {
                try {
                    const response = await fetch('http://localhost:5001/api/news');
                    if (!response.ok) throw new Error('Failed to fetch news');
                    
                    const news = await response.json();
                    this.displayNews(news);
                } catch (error) {
                    console.error('Error loading news:', error);
                    this.showError();
                }
            }

            displayNews(news) {
                this.newsLoading.classList.add('hidden');
                
                if (!news || news.length === 0) {
                    this.newsEmpty.classList.remove('hidden');
                    return;
                }

                this.newsContainer.classList.remove('hidden');
                this.newsContainer.innerHTML = news.map((item, index) => this.createNewsCard(item, index)).join('');
                
                // 初始化所有 Swiper 實例
                this.initializeSwipers(news);
            }

            createNewsCard(news, index) {
                const formattedDate = new Date(news.date).toLocaleDateString('zh-TW', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });

                // 創建圖片輪播 HTML
                const imageSlides = news.images && news.images.length > 0 
                    ? news.images.map(img => `
                        <div class="swiper-slide">
                            <img src="${img}" alt="${news.title}" class="w-full h-48 object-cover">
                        </div>
                    `).join('')
                    : `
                        <div class="swiper-slide">
                            <div class="w-full h-48 bg-gradient-to-br from-actc-orange to-actc-orange-dark flex items-center justify-center">
                                <svg class="w-16 h-16 text-white/70" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                            </div>
                        </div>
                    `;

                // 創建檔案下載和活動連結按鈕
                const actionButtons = [];
                if (news.file) {
                    actionButtons.push(`
                        <a href="${news.file}" target="_blank" class="inline-flex items-center px-3 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 transition-colors">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            下載檔案
                        </a>
                    `);
                }
                if (news.link) {
                    actionButtons.push(`
                        <a href="${news.link}" target="_blank" class="inline-flex items-center px-3 py-2 bg-actc-orange text-white text-sm rounded-md hover:bg-actc-orange-dark transition-colors">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-2M7 7l10 10M17 7h-4v4"></path>
                            </svg>
                            活動連結
                        </a>
                    `);
                }

                return `
                    <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
                        <!-- 圖片輪播區塊 -->
                        <div class="relative">
                            <div class="swiper news-swiper-${index}">
                                <div class="swiper-wrapper">
                                    ${imageSlides}
                                </div>
                                ${news.images && news.images.length > 1 ? `
                                    <div class="swiper-button-next"></div>
                                    <div class="swiper-button-prev"></div>
                                    <div class="swiper-pagination"></div>
                                ` : ''}
                            </div>
                        </div>
                        
                        <!-- 內容區塊 -->
                        <div class="p-6">
                            <!-- 日期標題 -->
                            <h3 class="text-lg font-bold text-actc-orange mb-2">${formattedDate}</h3>
                            
                            <!-- 活動說明 -->
                            <h4 class="text-xl font-semibold text-gray-800 mb-3">${news.title}</h4>
                            <p class="text-gray-600 mb-4 leading-relaxed">${news.description}</p>
                            
                            <!-- 按鈕區塊 -->
                            ${actionButtons.length > 0 ? `
                                <div class="flex flex-wrap gap-3 pt-4 border-t border-gray-100">
                                    ${actionButtons.join('')}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }

            initializeSwipers(news) {
                // 清理舊的 Swiper 實例
                this.swiperInstances.forEach(swiper => swiper.destroy());
                this.swiperInstances = [];

                // 為每個新聞卡片初始化 Swiper
                news.forEach((item, index) => {
                    if (item.images && item.images.length > 0) {
                        const swiper = new Swiper(`.news-swiper-${index}`, {
                            loop: item.images.length > 1,
                            autoplay: item.images.length > 1 ? {
                                delay: 4000,
                                disableOnInteraction: false,
                            } : false,
                            pagination: item.images.length > 1 ? {
                                el: `.news-swiper-${index} .swiper-pagination`,
                                clickable: true,
                            } : false,
                            navigation: item.images.length > 1 ? {
                                nextEl: `.news-swiper-${index} .swiper-button-next`,
                                prevEl: `.news-swiper-${index} .swiper-button-prev`,
                            } : false,
                        });
                        this.swiperInstances.push(swiper);
                    }
                });
            }

            showError() {
                this.newsLoading.classList.add('hidden');
                this.newsError.classList.remove('hidden');
            }
        }

        // 初始化新聞管理
        document.addEventListener('DOMContentLoaded', () => {
            new NewsManager();
        });
    </script>

    <!-- 活動管理 JavaScript -->
    <script>
        // 活動管理
        class EventsManager {
            constructor() {
                this.eventsContainer = document.getElementById('events-container');
                this.eventsLoading = document.getElementById('events-loading');
                this.eventsEmpty = document.getElementById('events-empty');
                this.eventsError = document.getElementById('events-error');
                this.init();
            }

            async init() {
                await this.loadEvents();
            }

            async loadEvents() {
                try {
                    const response = await fetch('http://localhost:5001/api/events');
                    if (!response.ok) throw new Error('Failed to fetch events');
                    
                    const events = await response.json();
                    this.displayEvents(events);
                } catch (error) {
                    console.error('Error loading events:', error);
                    this.showError();
                }
            }

            displayEvents(events) {
                this.eventsLoading.classList.add('hidden');
                
                if (!events || events.length === 0) {
                    this.eventsEmpty.classList.remove('hidden');
                    return;
                }

                this.eventsContainer.classList.remove('hidden');
                this.eventsContainer.innerHTML = events.map(event => this.createEventCard(event)).join('');
            }

            createEventCard(event) {
                const formattedDate = new Date(event.date).toLocaleDateString('zh-TW', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    weekday: 'short'
                });

                // 活動類型徽章樣式
                const typeStyles = {
                    'meetup': 'bg-blue-100 text-blue-800',
                    'workshop': 'bg-green-100 text-green-800',
                    'course': 'bg-purple-100 text-purple-800',
                    'others': 'bg-gray-100 text-gray-800'
                };

                const typeLabels = {
                    'meetup': '聚會',
                    'workshop': '工作坊',
                    'course': '課程',
                    'others': '其他'
                };

                // 檢測連結類型並產生對應圖示
                let linkIcon = '';
                if (event.link) {
                    const url = event.link.toLowerCase();
                    if (url.includes('discord')) {
                        linkIcon = '<i class="fab fa-discord text-blue-600"></i>';
                    } else if (url.includes('teams') || url.includes('microsoft')) {
                        linkIcon = '<i class="fab fa-microsoft text-blue-600"></i>';
                    } else {
                        linkIcon = '<i class="fas fa-external-link-alt text-blue-600"></i>';
                    }
                }

                return `
                    <div class="bg-white shadow-md rounded-lg p-4 hover:shadow-lg transition-shadow">
                        <!-- 主題 -->
                        <h3 class="text-xl font-semibold text-gray-800 mb-3">${event.title}</h3>
                        
                        <!-- 類型 -->
                        <div class="mb-3">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${typeStyles[event.type] || typeStyles['others']}">
                                ${typeLabels[event.type] || event.type}
                            </span>
                        </div>
                        
                        <!-- 簡介 -->
                        <p class="text-gray-600 mb-4 leading-relaxed">${event.description}</p>
                        
                        <!-- 日期 -->
                        <p class="text-sm text-gray-500 mb-2">
                            <i class="fas fa-calendar-alt mr-2 text-actc-orange"></i>
                            ${formattedDate}
                        </p>
                        
                        <!-- 地點 -->
                        <p class="text-sm text-gray-500 mb-4">
                            <i class="fas fa-map-marker-alt mr-2 text-actc-orange"></i>
                            ${event.location}
                        </p>
                        
                        <!-- 連結（如果存在） -->
                        ${event.link ? `
                            <div class="pt-3 border-t border-gray-100">
                                <a href="${event.link}" target="_blank" class="inline-flex items-center text-sm text-blue-600 hover:text-blue-800 transition-colors">
                                    ${linkIcon}
                                    <span class="ml-2">線上連結</span>
                                </a>
                            </div>
                        ` : ''}
                    </div>
                `;
            }

            showError() {
                this.eventsLoading.classList.add('hidden');
                this.eventsError.classList.remove('hidden');
            }
        }

        // 初始化活動管理
        document.addEventListener('DOMContentLoaded', () => {
            new EventsManager();
        });
    </script>

    <!-- 平滑滾動 JavaScript -->
    <script>
        // 平滑滾動到錨點
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // 導航欄高亮當前區塊
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('nav a[href^="#"]');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (scrollY >= (sectionTop - 200)) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('text-actc-orange');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('text-actc-orange');
                }
            });
        });
    </script>
</body>
</html>
